---
title: "Untitled"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
---
title: "Report"
output:
  pdf_document: default
  rmdformats::material: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
```

# Milestone 1.2

## Mechanism of action

After finding the drugs with the most effective response in regards to the ovary cancer cell lines, we now continued our analysis by testing if the efficiency of these drugs is dependent on the cancer cell line type or not. In order to test this we repeated many of the same steps as in milestone 1.1 but on all cell lines except the ovary cell lines. We extracted the most negative proliferation value for each drug in each cell line (except ovary), set the threshold to the 10% quantile, and then extracted the most common moas. The results of this are shown below:


```{r, echo=FALSE, fig.cap="Most frequent moa's amongst the most effective drugs"}

moa_frequencies = prism.treat_reduced_2 %>% count(moa) %>% filter(n >= 3)
moa_frequencies = moa_frequencies[0:9,]
par(mar=c(4, 20, 4, 4))
barplot(moa_frequencies$n, names.arg = moa_frequencies$moa, 
        las = 1, 
        xlab = "Frequency", 
        horiz = TRUE, 
        xlim = c(0,10),
        col = "Lightblue3",
        main = NULL) 

```
-> Cancer drugs:
- Topoisomerase inhibitors (https://www.ncbi.nlm.nih.gov/books/NBK548372/)
- Proteasome inhibitors (https://www.nature.com/articles/nrclinonc.2016.206)
- PI3K inhibitors (https://www.nature.com/articles/s41573-021-00209-1)
- NFkB pathway inhibitors (https://www.nature.com/articles/1209982)
- HDAC inhibitors (https://www.nature.com/articles/1210620)
- EGFR inhibitors (https://www.ncbi.nlm.nih.gov/pmc/articles/PMC2701650/)
- CDK inhibitors (https://www.nature.com/articles/s41467-020-16559-0) 
- BCL inhibitors (https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5729538/)
- ATPase inhibitors (https://www.future-science.com/doi/abs/10.4155/ppa.12.3)

As was the case with the selected moas amongst the ovary cell lines, all selected moas amongst the other cell lines are also commonly used in cancer therapy. Although the likelihood of finding non-oncological drugs with a strong negative effect on cell proliferation is very low, these results are nonetheless disappointing. 

## T-Tests

After finding the most common moas amongst the ovary and all other cell lines, respectively, the next step in our analysis was to find out if any of these moas showed a statistically significant efficiency in ovary cancer specifically. In order to test this, we decided to perform a t-test on all of our selected most common moas for ovary cancer and all other cell lines. The results are as follow: 

```{r}

fisher.test(fisher_topoisomerase)
fisher.test(fisher_proteasome)
fisher.test(fisher_PI3K)
fisher.test(fisher_NFkB)
fisher.test(fisher_hdac)
fisher.test(fisher_EGFR)
fisher.test(fisher_cdk)
fisher.test(fisher_BCL)
fisher.test(fisher_ATPase)


```

## PC1 vs. PC2 for All Cell Line Clusters

As a next step we decided to perform a PCA on all cell lines. We clustered by cell lines in order to test if the ovary cell lines would form their own distinctive cluster regarding the drug response. As can be seen in Fig. X, this was not the case. The fact that the ovary cell lines did not form their own cluster shows that there seems to be no combining trait among them that would trigger a similar drug response. 

```{r, echo = TRUE, fig.cap = "PC1 vs. PC2 for All Cell Line Clusters"}

A_moa_all = as.matrix(moa_drugs_all)

pca1_moa_all = prcomp(A_moa_all[,-42], scale = TRUE)

colVec = vector(length = nrow(A_moa_all))
colVec[which(rownames(A_moa_all) %in% df_ovary_cl$DepMap_ID)] = "red"
colVec[-which(rownames(A_moa_all) %in% df_ovary_cl$DepMap_ID)] = "gray"

plot(pca1_moa_all$x[,1], pca1_moa_all$x[,2], pch=20, col = colVec, 
     xlab='PC1',ylab='PC2',
      main = "PC1 vs. PC2 for All Cell Line Clusters")
      legend("topleft", legend = c("Ovary cell lines", "Other cell lines"), fill = c("Red", "Gray"))

```

