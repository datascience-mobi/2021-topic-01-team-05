---
title: "Untitled"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
---
title: "Report"
output:
  pdf_document: default
  rmdformats::material: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
```

# Milestone 1.2

## Mechanism of action

After finding the drugs with the most effective response in regards to the ovary cancer cell lines, we now continued our analysis by testing if the efficiency of these drugs is dependent on the cancer cell line type or not. In order to test this we repeated many of the same steps as in milestone 1.1 but on all cell lines except the ovary cell lines. We extracted the most negative proliferation value for each drug in each cell line (except ovary), set the threshold to the 10% quantile, and then extracted the most common moas. The results of this are shown below:


```{r, echo=FALSE, fig.cap="Most frequent moa's amongst the most effective drugs"}

moa_frequencies = prism.treat_reduced_2 %>% count(moa) %>% filter(n >= 3)
moa_frequencies = moa_frequencies[0:9,]
par(mar=c(4, 20, 4, 4))
barplot(moa_frequencies$n, names.arg = moa_frequencies$moa, 
        las = 1, 
        xlab = "Frequency", 
        horiz = TRUE, 
        xlim = c(0,10),
        col = "Lightblue3",
        main = NULL) 

```
-> Cancer drugs:

- NFkB pathway inhibitors (https://www.nature.com/articles/1209982)

As can be seen in Fig. X, all but one of the most frequently occurring moas are the same as the most frequently occurring moas in ovary cancer cell lines, however; the frequency with which they occur in the other cell lines differs slightly from the frequency with which they occur in the ovary cell lines. The NFkB pathway inhibitor is the one moa that appears among the 45 most frequent moas in the other cell lines three times but not at all in the 45 most frequent moas in the ovary cell lines. Although NFkB pathway inhibitors do occur in the ovary cell lines twice, this is not often enough to have made the top 45 which explains why they are not shown in Fig X. NFkB transcription factors are often used to regulate inflammation and immune responses, cell growth, apoptosis, and the expression of certain viral genes [@Gilmore2006]. Due to the importance of the NFkB transcription factors in regulating these processes, NFkB pathway inhibitors are often used in treating chronic inflammation and cancer. 

## Fisher - Exact Tests

After finding the most common moas among the ovary and all other cell lines, respectively, the next step in our analysis was to find out if any of these moas showed a statistically significant efficiency in ovary cancer specifically. In order to test this, we decided to perform a fisher-exact-test on all of our selected most common moas for ovary cancer and all other cell lines.

```{r}

fisher.test(fisher_topoisomerase)
fisher.test(fisher_proteasome)
fisher.test(fisher_PI3K)
fisher.test(fisher_NFkB)
fisher.test(fisher_hdac)
fisher.test(fisher_EGFR)
fisher.test(fisher_cdk)
fisher.test(fisher_BCL)
fisher.test(fisher_ATPase)


```
The results of the fisher-exact-test show that there is no statistically significant difference in the occurrence of the moas between the ovary cell lines and the other cell lines. In order for the null hypothesis - that the odds ratio is equal to one - to be rejected, the p-value must be smaller than our confidence level of 0.05. The p-value is larger than 0.05 in every fisher test we conducted. This means that the H0 hypothesis cannot be rejected and therefore the odds ratio must be one. An odds ratio of one means that there is no relation between the number of times a specific moa occurs and the cell line type of either ovary or all others. 


## PC1 vs. PC2 for All Cell Line Clusters

As a next step we decided to perform a PCA on all cell lines. We clustered by cell lines in order to test if the ovary cell lines would form their own distinctive cluster regarding the drug response. As can be seen in Fig. X, this was not the case. The fact that the ovary cell lines did not form their own cluster shows that there seems to be no combining trait among them that would trigger a similar drug response. 

```{r, echo = TRUE, fig.cap = "PC1 vs. PC2 for All Cell Line Clusters"}

A_moa_all = as.matrix(moa_drugs_all)

pca1_moa_all = prcomp(A_moa_all[,-42], scale = TRUE)

colVec = vector(length = nrow(A_moa_all))
colVec[which(rownames(A_moa_all) %in% df_ovary_cl$DepMap_ID)] = "red"
colVec[-which(rownames(A_moa_all) %in% df_ovary_cl$DepMap_ID)] = "gray"

plot(pca1_moa_all$x[,1], pca1_moa_all$x[,2], pch=20, col = colVec, 
     xlab='PC1',ylab='PC2',
      main = "PC1 vs. PC2 for All Cell Line Clusters")
      legend("topleft", legend = c("Ovary cell lines", "Other cell lines"), fill = c("Red", "Gray"))

```

## Drug for linear regression 
https://pubchem.ncbi.nlm.nih.gov/compound/Zardaverine 
