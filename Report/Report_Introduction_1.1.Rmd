---
title: "**Report - Project 01 - Group 05**"
author: "Carolin Bayan, Savannah Cattarius, Laura Diekmann, Rositsa Todorovska"
date: "07/19/2020"
bibliography: ../Bibliography/References.bibtex
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
```


```{r, include=FALSE}
load("../Original_Environment/Original.RData")
```


# Introduction

Drug repurposing describes the strategy [@alberts2017molecular] of reusing drugs that have already been approved for other medical applications. These drugs can obtain a new purpose by using them in a different therapeutic indication. This approach offers several advantages compared to the development and research of novel drugs. 
Drug repurposing allows researchers to use already approved pharmaceuticals, which helps them face less obstacles regarding potential side effects and the general approval of these drugs. This is due to the fact that the safety of the drugs has already been tested and validated in prior researches. Therefore, costs and legal requirements can be reduced which results in a quicker development of new treatment options [@Pushpakom2019].

According to the WHO [^1] , cancer is the second leading cause of death in the United States and a major global health problem. In addition, the progress of diagnosing and treating this disease was set back due to the coronavirus disease 2019 (COVID-19) pandemic which resulted in reduced health care capacities [@https://doi.org/10.3322/caac.21654]. Hence, finding new treatment options by repurposing drugs in order to safe resources and time seems to be essential for our society.

For our project, we used data obtained from a large screening of 1396 oncological and non-oncological drugs that were tested on 481 different cancer cell lines [@Corsello2020]. While also working with the whole data consisting of several different cancer cell lines, in our analysis we particularly focused on the included 30 ovarian cancer cell lines. The American Cancer Society states that ovarian cancer causes more deaths than any other form of cancer being related to the female reproductive system [^2].

[^1]: https://www.who.int/health-topics/cancer#tab=tab_1
[^2]: https://www.cancer.org/cancer/ovarian-cancer/about/key-statistics.html

We aimed to answer two main questions:

> 1. How do different drugs influence ovary cancer cell lines and which are particularly noticeable? How do these drugs affect the other cell lines?

> 2. Is the sensitivity of different drugs on ovary cancer cell lines connected to specific cancer-related genes or gene knock-outs?

We subdivided our project into 6 milestones in order to find answers to these questions.

In **milestone 1.1 and 1.2** we analyzed the drugs and their influence on the proliferation of cancer cell lines and we were able to identify the most promising drugs based on their mechanism of action (moa).

In **milestone 1.3**, we analyzed to what extent the used drug dosage had an effect on the proliferation values of the cancer cell lines and found out that the higher the dosage the greater the effect on proliferation.

**Milestone 2.1** ...

In **milestone 2.2**, we investigated the drug response of the ovarian cancer cell lines based on certain gene expression patterns and knockdown scores. This showed...  

Finally, in **milestone 2.3** we used our results to perform a linear regression model in order to predict drug efficiency from certain gene mutations or expressions.

\newpage

# Milestone 1.1

## General overview

Using the provided prism data frame, we extracted the ovarian DepMap_IDs with their proliferation values after drug treatment.
In order to get a general overview of our data, we computed two histograms showing the distribution of the mean sensitivity across all ovarian cell lines and all drugs.


```{r, echo=FALSE, fig.cap="**Left:** Ovarian Cancer Cell Lines Mean Sensitivity towards Drugs  **Right:** Mean Drug Efficiency regarding Proliferation in Ovarian Cell Lines", fig.height=4, fig.width=6.5}

par(mfrow = c(1,2))
hist_cell_growth_cl  <- hist(apply(df_ovary_DepMI_prism, 1,function(x){mean(x,na.rm=TRUE)}),
        breaks = 50, 
        xlim = c(-0.9, 0),
        main = NULL,
        xlab = "Mean log fold-change in cell growth",
        col="lightblue3")

hist_cell_growth_drugs <- hist(apply(df_ovary_DepMI_prism, 2,function(x){mean(x,na.rm=TRUE)}),
                               breaks = 50,
                               main = NULL,
                               xlab = "Mean log fold-change in cell growth", col="lightblue3")
abline(v = 0, col = "red", lwd = 1.5)
```

The left plot in Fig. 1 shows that all ovarian cancer cell lines had a mean sensitivity towards the drugs of less than or equal to zero, which showed us that in general, the applied drugs seemed to have a promising effect on their cell growth.

The right plot shows all values for the mean drug efficiency in ovarian cell lines. Values below zero indicate negative proliferation. In total, 8652 drugs lie below zero. This means that these drugs generally - with regard to their mean values - caused a reduction in cell growth when they were administered to the ovarian cell lines.  

## Setting a threshold

In our next step, we further analyzed the prism data set. Our aim was to determine the strongest effect each drug had on the ovarian cancer cell lines in terms of proliferation values - independent of the dosage that was used. This is why for each drug, we chose its minimum value which reflects the strongest negative effect on proliferation of the ovarian cell lines.
In order to be able to work with a manageable amount of drugs, we decided to set a threshold at the 10 % quantile (see Fig. 3) By doing so, we could focus on the 140 most effective drugs which caused the most negative proliferation values.

```{r, echo=FALSE, fig.cap="Most Effective Drug-Proliferation Values in Ovarian Cell Lines", fig.height=3.5, fig.width=4}
hist(min_values_treat_prism_reduced_ovary_vector,
     main = NULL,
     xlab = "Minimum values for each drug",
     col = "Lightblue3")
abline(v=quantile(min_values_treat_prism_reduced_ovary_vector, 0.1), col = "red", lwd=2.5)
text(-10, 175, "10 % quantile", col = "red", lwd = 2)
```


## Mechanism of Action

While further analyzing the drugs that lie below the 10 % quantile, we focused on categorizing them after their mechanism of action which we found in the data set prism.treat. Unfortunately, the data regarding the usual disease areas and indications of the drugs was very incomplete, which is why we decided to further investigate the moas - these showed the lowest number of NA values and can also help determining whether these drugs are normally used for treating cancer or not.

Our results are shown in Fig. 4. These are the 45 most common moas regarding the drugs that had the most promising effects on the ovarian cancer cell lines.

```{r, echo=FALSE, fig.cap="Most frequent moas amongst the most effective drugs"}

most_common_moas_ovary <- reduced_prism_treat_ovary_df_2 %>% count(moa) %>% filter(n >= 3)
most_common_moas_ovary <- most_common_moas_ovary[0:8,]

par(mar=c(4,20,4,4))
barplot(most_common_moas_ovary$n,
        names.arg = most_common_moas_ovary$moa,
        las = 1,
        xlab = "Frequency",
        horiz = TRUE,
        col = "Lightblue3",
        main = NULL)
```

We further investigated these moas and came to the following results. 

10 out of the chosen 140 most promising drugs are HDAC inhibitors. Their epigenetic targets include amongst other things HDAC3, HDAC4, HDAC8. These are epigenetic targets for noncancer drug repurposing candiates [@Moreira-Silva2020] and were also found to be potential anti-cancer agents for inhibiting cancer cell migration and invasion in ovarian cancer [@AHN2012189].

With 9 occurrences, the topoisomerase inhibitors are the second most frequent moas we found. However, this is not surprising since these drugs are commonly used in cancer therapy, thus they showed strong effects on the cancer cell lines [@Parchment1998]. Interestingly, the drug mitoxantrone is also used in the disease area neurology/psychiatry and multiple sclerosis[^3].

In addition, CDK inhibitors appeared seven times in our findings regarding the most effective and common moas for treating ovarian cancer. Especially the targets CDK4 and CDK6 showed promising results in a different study [@Iyengar2018] as a new therpeutic approach to treat ovarian cancer. 

We found 6 proteasome inhibitors to be most effective against ovarian cancer cell lines. They are an important class of drugs against multiple myeloma and cell lymphoma. However, they are currently in clinical trials for other types of cancer [@doi:10.1146/annurev-pharmtox-010919-023603] which is why it makes sense for us that we also found them to have promising effects in our analysis. 

In a different study, researchers found that EGFR is not a suitable target for ovarian cancer therapy [@Mehner2017] and seems to be more effective for lung cancer and pancreas cancer therapy. However, we found three EGFR inhibitors with effective impacts on ovarian cancer cell lines. 

The remaining three moas: PI3K- [@Vanhaesebroeck2021], BCL- [@Montero2018] and ATPase-inhibitors [@doi:10.4155/ppa.12.3], are all cancer related moas. Therefore, all of them are commonly used in cancer therapy which is why it is not surprising that they appeard in our findings. 

[^3]: National Center for Biotechnology Information (2021). PubChem Compound Summary for CID 4212, Mitoxantrone. Retrieved July 11, 2021 from https://pubchem.ncbi.nlm.nih.gov/compound/Mitoxantrone.



## Dimension Reduction

Our next step included performing kmeans and finding the optimal number of clusters in order to compute a principal component analysis (PCA). 

```{r, echo=FALSE, fig.cap="Variance explained by mechanism of action PCs", fig.height=3.5, fig.width=4}
B_moa = as.matrix(moa_drugs_ovary)
pca2_moa = prcomp(B_moa, scale = TRUE)
pca2_var_moa = pca2_moa$sdev^2
pca2_var_per_moa = round(pca2_var_moa/sum(pca2_var_moa)*100,1)


barplot(pca2_var_per_moa, main = NULL,
        xlab = "Principal component",
        ylab = "Percent variation",
        col = "Lightblue3")
```


As you can see from the plot (see Fig. 5), the majority of the variance is explained by using the first two principal components.

```{r, echo=FALSE, fig.cap = "Elbow Method for Finding Optimal Number of Clusters", fig.height=3.5, fig.width=4}
wss2_moa = sapply(2:7,function(k) {
  kmeans(x=pca2_moa$x[,1:2], centers = k)$tot.withinss
})
plot(2:7,wss2_moa,type='b',
     pch=20,
     xlab="Number of clusters K",
     ylab="Total within-clusters sum of squares",
     main = NULL)
```

In order to find the most optimal number of clusters for our PCA of PC1 and PC2, we used the elbow method. As a result, the optimal number of clusters seems to be 4 (see Fig. 6).


```{r, echo=FALSE, fig.cap = "PC1 vs. PC2 for Ovary Cell Line Clusters", fig.height=4, fig.width=4.5}
km2_moa = kmeans(pca2_moa$x[,1:2],centers=4,nstart = 100)
col = c("Lightblue", "Lightblue4", "royalblue1", "darkblue")
col.km2_moa = col[km2_moa$cluster]
plot(pca2_moa$x[,1], pca2_moa$x[,2],
col= col.km2_moa, pch=20,
xlab='PC1',ylab='PC2',
main = NULL)
legend("topright", legend = c("Cluster 1", "Cluster 2", "Cluster 3", "Cluster 4"), fill = col, cex = 0.5)
```

Fig. 7 shows 
...
ANALYSIS noch
...

We also plotted barplots of PC1 and PC2 in order to determine the contribution of the different variables to our PCA.


cell lines unterscheiden sich besopnders in der reaktion auf die medikamente mit größter contribution in pc1


```{r, echo = FALSE, fig.cap = "Contribution to PC1"}
# 1st pc
barplot(sort(pca2_moa$rotation[,1]), las=3, cex.names = 0.6, main = NULL, col = "Lightblue3")
```



```{r Milestone 1.3}


```

```{r Milestone 2.1}

```


```{r Milestone 2.2}

```


```{r Milestone 2.3}

```



# References

